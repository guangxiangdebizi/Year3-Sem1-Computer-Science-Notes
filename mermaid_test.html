<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mermaid 图表测试</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #333;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }
        .mermaid {
            text-align: center;
            margin: 20px 0;
            background: #fafafa;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>数据库原理 Mermaid 图表修复验证</h1>
        
        <div class="status success">
            ✅ 所有 Mermaid 语法错误已修复完成！
        </div>

        <h2>修复示例 1: 第6章 - 码的层次结构（花括号修复）</h2>
        <div class="mermaid">
graph TD
    A[码的层次结构] --> B[超码 Super Key]
    B --> C[候选码 Candidate Key]
    C --> D[主码 Primary Key]
    
    B --> B1[能唯一标识元组的<br/>属性或属性组]
    C --> C1[最小的超码<br/>去掉任何属性都不是超码]
    D --> D1[从候选码中选择的<br/>一个作为主码]
    
    subgraph "示例：学生选课关系"
        E["超码: {Sno,Cno,Sname}"]
        F["候选码: {Sno,Cno}"]
        G["主码: {Sno,Cno}"]
        H[主属性: Sno, Cno]
        I[非主属性: Sname, Grade]
    end
    
    style D fill:#ffcdd2
    style H fill:#e8f5e8
    style I fill:#bbdefb
        </div>

        <h2>修复示例 2: 第6章 - 第一范式（管道符号修复）</h2>
        <div class="mermaid">
graph LR
    subgraph "不满足1NF"
        A["学生表<br/>学号|姓名|联系方式"]
        B["001|张三|电话:123 邮箱:abc@qq.com"]
    end
    
    subgraph "满足1NF"
        C["学生表<br/>学号|姓名|电话|邮箱"]
        D["001|张三|123|abc@qq.com"]
    end
    
    A --> C
    style A fill:#ffcdd2
    style C fill:#e8f5e8
        </div>

        <h2>修复示例 3: 第9章 - 日志记录示例（尖括号修复）</h2>
        <div class="mermaid">
graph TD
    A[日志文件结构] --> B[事务日志记录]
    
    subgraph "日志记录示例"
        H["&lt;T1, BEGIN&gt;"]
        I["&lt;T1, X, 100, 200&gt;"]
        J["&lt;T1, Y, 50, 80&gt;"]
        K["&lt;T1, COMMIT&gt;"]
    end
    
    style H fill:#e3f2fd
    style I fill:#fff3e0
    style J fill:#fff3e0
    style K fill:#e8f5e8
        </div>

        <h2>修复总结</h2>
        <div style="background: #f8f9fa; padding: 15px; border-radius: 5px; border-left: 4px solid #4CAF50;">
            <h3>已修复的语法错误类型：</h3>
            <ul>
                <li><strong>尖括号问题</strong>：将 <code>&lt;</code> 和 <code>&gt;</code> 转换为HTML实体编码或用引号包围</li>
                <li><strong>花括号问题</strong>：将包含 <code>{}</code> 的节点标签用双引号包围</li>
                <li><strong>管道符号问题</strong>：将包含 <code>|</code> 的节点标签用双引号包围</li>
                <li><strong>代码块结束标记</strong>：确保所有Mermaid代码块都有正确的 <code>```</code> 结束标记</li>
            </ul>
            
            <h3>修复的文件：</h3>
            <ul>
                <li>第2章_关系数据库.md</li>
                <li>第3章_关系数据库标准语言SQL.md</li>
                <li>第5章_数据库完整性.md</li>
                <li>第6章_关系数据理论.md</li>
                <li>第9章_数据库恢复技术.md</li>
                <li>第10章_并发控制.md</li>
                <li>第11章_数据库管理系统.md</li>
                <li>第13章_分布式数据库系统.md</li>
                <li>第14章_对象关系数据库.md</li>
            </ul>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#4CAF50',
                primaryTextColor: '#333',
                primaryBorderColor: '#4CAF50',
                lineColor: '#666',
                secondaryColor: '#f8f9fa',
                tertiaryColor: '#e8f5e8'
            }
        });
    </script>
</body>
</html>