# 信息安全技术实验报告

## 实验名称：经典密码算法实现与应用

---

## 一、实验目的和要求

- 通过编程实践掌握 DES、RSA、SHA-1 等经典密码算法的工作原理与应用流程。
- 能够独立实现算法的加解密/摘要功能，不依赖第三方加密库。
- 使用实例验证算法的正确性，整理实验现象、问题和结论。
- 在实验报告中呈现系统分析、设计、实现、测试等内容，包含图形化界面及运行截图。

---

## 二、实验内容

1. 使用具体实例，实现 DES 算法的加密与解密。
2. 使用具体实例，实现 RSA 算法的加密与解密。
3. 使用具体实例，实现 SHA-1 算法的消息摘要计算。
4. 设计一个图形化界面（GUI），方便综合演示三种算法。
5. 撰写实验报告，总结实验过程、测试结果与心得体会。

---

## 三、系统分析

### 1. 功能分析

- **DES 模块**：支持任意 UTF-8 文本加/解密，采用 PKCS#7 填充方式，输出十六进制密文。
- **RSA 模块**：包含素数生成、密钥对生成、公私钥加解密（字符与数字），支持自定义密钥长度。
- **SHA-1 模块**：实现原始算法流程，支持字符串与文件摘要。
- **综合测试**：模拟安全通信流程，组合使用 SHA-1、DES、RSA。
- **GUI 界面**：通过 Tkinter 提供 DES/RSA/SHA-1 的交互操作和综合演示。

### 2. 约束与要求

- 不能调用现成的加密库函数，需从底层实现核心步骤（置换、S盒、模指数运算等）。
- DES 密钥限定为 8 字节；RSA 密钥长度建议 ≥256 位以兼顾安全与运行时间；SHA-1 输出为 160 位摘要。
- 代码使用 Python 编写，要求可在 Windows 环境下运行。

### 3. 风险与对策

- **算法复杂度高**：提前查阅标准流程，逐步实现并单元测试。
- **大数运算性能**：适度降低演示用 RSA 密钥长度（256 位）以保证体验。
- **编码兼容性**：统一使用 UTF-8 字节处理，解密后进行填充校验。

---

## 四、系统设计

### 1. 模块划分

- `des.py`：包含 DES 算法常量、密钥调度、F 函数、加解密流程及测试函数。
- `rsa.py`：包含 Miller-Rabin 素性检测、扩展欧几里得算法、模逆、密钥生成与加解密。
- `sha1.py`：包含消息填充、分块处理、主循环以及测试用例。
- `main.py`：命令行综合测试程序，串联三种算法并模拟安全通信场景。
- `gui.py`：基于 Tkinter 的图形化界面，实现交互式演示。

### 2. 数据结构与处理流程

- DES 内部使用比特列表（0/1）表示数据块，通过置换表索引实现转换。
- RSA 使用 Python 原生大整数支持，分块处理字符，密文以整数列表表示。
- SHA-1 使用 32 位整型寄存器模拟算法轮次和位运算。
- 综合演示中，先对消息求摘要，再使用 DES 加密消息，最后用 RSA 加密临时密钥。

### 3. 图形界面设计

- 使用 Notebook 选项卡划分功能区：DES、RSA、SHA-1、综合演示。
- 每个选项卡提供输入框、按钮和输出区域，便于操作与查看结果。
- 综合演示选项卡展示完整的通信流程日志，帮助理解各步骤。

---

## 五、系统实现

### 1. DES 关键函数示例

```220:268:信息安全技术/作业1/des.py
        if isinstance(plaintext, str):
            plaintext_bytes = plaintext.encode('utf-8')
        else:
            plaintext_bytes = bytes(plaintext)
        
        # PKCS#7填充
        pad_len = 8 - (len(plaintext_bytes) % 8)
        if pad_len == 0:
            pad_len = 8
        plaintext_bytes += bytes([pad_len] * pad_len)
        
        ciphertext_bits = []
        
        # 分块加密
        for i in range(0, len(plaintext_bytes), 8):
            block = plaintext_bytes[i:i + 8]
            block_bits = self._bytes_to_bits(block)
            encrypted_block = self._process_block(block_bits, self.sub_keys)
            ciphertext_bits.extend(encrypted_block)
```

- 先进行 UTF-8 编码与 PKCS#7 填充，保证任意长度消息均可分成 64 位块。
- `_process_block` 内包含初始置换、16 轮 Feistel 结构和逆置换，严格遵循 DES 标准。

### 2. RSA 关键函数示例

```125:172:信息安全技术/作业1/rsa.py
    def _generate_prime(self, bits):
        """
        生成指定位数的素数
        :param bits: 素数的位数
        :return: 素数
        """
        while True:
            num = random.getrandbits(bits)
            num |= (1 << (bits - 1))
            num |= 1
            if self._is_prime(num):
                return num
```

- 使用 Miller-Rabin 随机测试生成大素数，确保密钥安全性。
- 通过扩展欧几里得算法计算模逆得到私钥指数。

### 3. SHA-1 关键函数示例

```58:104:信息安全技术/作业1/sha1.py
        for i in range(80):
            if 0 <= i <= 19:
                f = (b & c) | ((~b) & d)
                k = 0x5A827999
            elif 20 <= i <= 39:
                f = b ^ c ^ d
                k = 0x6ED9EBA1
            elif 40 <= i <= 59:
                f = (b & c) | (b & d) | (c & d)
                k = 0x8F1BBCDC
            else:
                f = b ^ c ^ d
                k = 0xCA62C1D6
            temp = (self._left_rotate(a, 5) + f + e + k + w[i]) & 0xffffffff
            e = d
            d = c
            c = self._left_rotate(b, 30)
            b = a
            a = temp
```

- 完整实现 80 轮主循环，分别对应 4 种布尔函数和常数。

### 4. 图形界面示例

```1:108:信息安全技术/作业1/gui.py
class CryptoGUI:
    """经典密码算法图形化演示工具"""

    def __init__(self, master):
        self.master = master
        master.title("信息安全技术实验 - 经典密码算法演示")
        master.geometry("900x700")
        ...
        notebook = ttk.Notebook(master)
        notebook.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)
        ...
        # DES 标签页、RSA 标签页、SHA 标签页、综合演示标签页
```

- GUI 提供按钮和文本框，操作直观，并配有日志输出。

### 5. 综合测试主程序

```45:99:信息安全技术/作业1/main.py
    message_digest = sha1.hash(original_message)
    ...
    encrypted_message = des.encrypt(original_message)
    ...
    encrypted_key = rsa.encrypt(des_key)
    ...
    decrypted_key = rsa.decrypt(encrypted_key)
    ...
    decrypted_message = des2.decrypt(encrypted_message)
    ...
    decrypted_digest = sha1.hash(decrypted_message)
```

- 通过串联调用三种算法，模拟“摘要 + 对称加密 + 公钥加密”的安全通信流程。

---

## 六、系统测试

### 1. 命令行测试结果概览

```1:205:信息安全技术/作业1/main.py执行日志
des.py、rsa.py、sha1.py 单独运行均显示加解密/摘要验证通过。
main.py 综合测试中各步骤输出如下：
- DES 加解密成功，密文示例：F5B112E6D0DD1238C6BE717A821F40FE...
- RSA 密钥生成成功，字符串与数字加解密验证通过。
- SHA-1 多组测试（空串、abc、英文句子、中文等）均与预期一致。
- 综合演示：原始消息“这是一条重要的机密信息！”通过 DES 加密、RSA 加密临时密钥，解密后消息与摘要均保持一致，验证成功。
```

### 2. 图形界面测试

- DES 标签：输入“信息安全技术 DES 测试”后，可成功加解密。
- RSA 标签：生成 256 位密钥，字符串加解密一致，密文以整型列表显示。
- SHA-1 标签：输入任意字符串，立即得到 40 位十六进制摘要。
- 综合演示标签：日志详细记录每一步操作，最终给出“✔”或“✘”提示。

### 3. 运行截图说明

- `screenshots/des_encrypt.png`：DES 界面加密结果截图。
- `screenshots/rsa_demo.png`：RSA 界面显示密钥与密文。
- `screenshots/sha1_demo.png`：SHA-1 摘要计算结果。
- `screenshots/gui_overview.png`：GUI 主界面概览。
- `screenshots/main_console.png`：命令行综合测试成功记录。

*(截图存放于 `信息安全技术/作业1/screenshots/` 目录，可根据实际情况补充。)*

---

## 七、实验问题与解决

1. **DES 解密中文出现乱码**：初始实现按字符处理未考虑 UTF-8，多字节字符导致填充失效。改为按字节操作并使用 PKCS#7 填充后解决。
2. **RSA 素数生成耗时**：默认密钥长度过大时生成耗时明显，演示阶段降低到 256 位，并保持正确性与效率平衡。
3. **SHA-1 摘要验证**：通过对比 RFC 参考结果校验正确性；使用多个测试用例确保实现无误。
4. **GUI 交互异常处理**：增加输入校验与弹窗提示，避免用户误操作导致程序终止。

---

## 八、实验总结

- 通过手动实现三种经典算法，加深了对对称加密、非对称加密与哈希函数内部机制的理解。
- 编程过程中体会到标准规范与测试用例的重要性，每个模块都需分步验证以确保正确性。
- 综合演示展示了“数字签名 + 机密性 + 完整性”的完整流程，为理解现实中的安全传输提供了实践基础。
- 图形化界面有助于演示与教学，也提升了对用户交互设计的关注。

---

## 九、附件与运行说明

1. **项目结构**
   ```
   信息安全技术/作业1/
       des.py
       rsa.py
       sha1.py
       main.py
       gui.py
       run_tests.bat
       实验报告.md
       screenshots/
   ```

2. **运行步骤**
   - 命令行测试：
     ```
     cd 信息安全技术\作业1
     python main.py
     ```
   - 图形界面：
     ```
     python gui.py
     ```
   - 批量测试：运行 `run_tests.bat`（可在命令提示符中双击执行）。

3. **环境要求**
   - Windows 10 及以上
   - Python 3.9+
   - 无需额外第三方库

4. **源码与文档**
   - 源码保存在 `信息安全技术/作业1/` 下，可直接查看。
   - 报告文件即本文件 `实验报告.md`。
   - 截图需根据最终运行结果补充至 `screenshots/` 目录。

---

**实验完成时间**：2025 年 9 月 30 日

**实验者**：________________（请填写姓名与学号）
